<p style="color: green"><%= notice %></p>

<h1>Movies</h1>

<%= form_with url: movies_path, method: :get, local: true, id: 'ratings_form' do %>
  <p>Include:</p>
  <% @all_ratings.each do |rating| %>
    <%= check_box_tag "ratings[#{rating}]", 1, @ratings_to_show.include?(rating), id: "ratings_#{rating}" %>
    <%= label_tag "ratings_#{rating}", rating %>
  <% end %>
  <p><%= submit_tag 'Refresh', id: 'ratings_submit' %></p>
<% end %>

<table id="movies">
  <thead>
    <tr>
      <th id="title_header" class="<%= 'hilite' if @sort == 'title' %>">
        <%= link_to 'Movie Title', movies_path(request.query_parameters.merge(sort: 'title')) %>
      </th>
      <th>Rating</th>
      <th id="release_date_header" class="<%= 'hilite' if @sort == 'release_date' %>">
        <%= link_to 'Release Date', movies_path(request.query_parameters.merge(sort: 'release_date')) %>
      </th>
      <th>More Info</th>
    </tr>
  </thead>
  <tbody>
    <% @movies.each do |movie| %>
      <tr>
        <td><%= movie.title %></td>
        <td><%= movie.rating %></td>
        <td><%= movie.release_date %></td>
        <td><%= link_to 'Show this movie', movie %></td>
      </tr>
    <% end %>
  </tbody>
</table>


<p><%= link_to 'New movie', new_movie_path %></p>